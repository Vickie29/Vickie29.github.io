{"title":"如何使用MATLAB调用摄像头—代码详解","slug":"如何使用MATLAB调用摄像头—代码详解","date":"2020-06-17","updated":"2020-07-08","comments":true,"path":"api/posts/60879.json","excerpt":"<blockquote><p>大家也可以加我的交流群，所有资料我会在群里分享出来哦：977947271</p><p>2020/5/30：</p></blockquote><p>最近在做关于图像识别的项目。</p><p>接触了MATLAB的许多操作，在这里做下关于调用笔记本摄像头的笔记。</p>","cover":null,"covers":null,"content":"<blockquote>\n<p>大家也可以加我的交流群，所有资料我会在群里分享出来哦：977947271</p>\n<p>2020/5/30：</p>\n</blockquote>\n<p>最近在做关于图像识别的项目。</p>\n<p>接触了MATLAB的许多操作，在这里做下关于调用笔记本摄像头的笔记。</p>\n<a id=\"more\"></a>\n<p>首先需要了解imaqhwinfo函数，在命令行输入imaqhwinfo就可以看到自己笔记本相关适配器和MATLAB版本的信息.但并不能看到摄像头的信息。</p>\n<!--more-->\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;imaqhwinfo</span><br><span class=\"line\">ans =  </span><br><span class=\"line\">   包含以下字段的struct:</span><br><span class=\"line\"> </span><br><span class=\"line\">       InstalledAdaptors:  &#123;<span class=\"string\">'winvideo'</span>&#125;</span><br><span class=\"line\">           MATLABVersion:  <span class=\"string\">'9.4 ( R2018a ) '</span></span><br><span class=\"line\">             ToolboxName: <span class=\"string\">'Image Acquisition Toolbox'</span></span><br><span class=\"line\">          ToolboxVersion: <span class=\"string\">'5.4 (R2018a)'</span>`</span><br></pre></td></tr></table></figure>\n<p>想要了解摄像头的信息就需要在imaqhwinfo中添加相关函数</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;imaqhwinfo(<span class=\"string\">'winvideo'</span>)</span><br></pre></td></tr></table></figure>\n<p>下面是适配器相关信息</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ans = </span><br><span class=\"line\">  包含以下字段的struct:</span><br><span class=\"line\">  </span><br><span class=\"line\">      AdaptorDllName: <span class=\"string\">'C:\\MATLAB\\mwwinvideoimaq.dll'</span></span><br><span class=\"line\">   AdaptorDllVersion: <span class=\"string\">'5.4 (R2018)'</span></span><br><span class=\"line\">         AdaptorName: <span class=\"string\">'winvideo'</span></span><br><span class=\"line\">           DeviceIDs: &#123;[<span class=\"number\">1</span>]&#125;</span><br><span class=\"line\">          DeviceInfo: [<span class=\"number\">1</span>×<span class=\"number\">1</span> struct]</span><br></pre></td></tr></table></figure>\n<p>imaqhwinfo()返回的是一个结构体，其中 DeviceID 和 DeviceInfo比较重要。DeviceID 储存着电脑上所有可用摄像头的ID，每个ID对应着电脑可用的一个摄像头；DeviceInfo 里面储存着摄像头的信息，就是我们平时所说的视频格式。</p>\n<p>下面以我的电脑为例：</p>\n<p>使用 DeviceInfo.DeviceID 可以看到摄像头的 ID 为 1</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;I = imaqhwinfo(<span class=\"string\">'winvideo'</span>);</span><br><span class=\"line\">&gt;&gt;I.DeviceInfo.DeviceID</span><br><span class=\"line\"> ans =</span><br><span class=\"line\"> \t<span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n<p>使用 DeviceInfo.SupportedFormats 函数可得到我的摄像头支持的格式是<br>{‘YUY2_160x120’}    {‘YUY2_320x240’}    {‘YUY2_640x480’}这三种。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;I = imaqhwinfo(<span class=\"string\">'winvideo'</span>);</span><br><span class=\"line\">&gt;&gt;I.DeviceInfo.SupportedFormats</span><br><span class=\"line\">ans =</span><br><span class=\"line\">     <span class=\"number\">1</span>×<span class=\"number\">3</span>cell 数组</span><br><span class=\"line\">     &#123;<span class=\"string\">'YUY2_160x120'</span>&#125;    &#123;<span class=\"string\">'YUY2_320x240'</span>&#125;    &#123;<span class=\"string\">'YUY2_640x480'</span>&#125;</span><br></pre></td></tr></table></figure>\n<p>调用摄像头注意这个函数 videoinput（adaptorname，deviceID，format）</p>\n<p>如果我使用ID为 ‘1’ 的摄像头，格式选择为{‘YUY2_640x480’}，</p>\n<p>那么代码为</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">videoinput(<span class=\"string\">'winvideo'</span>,<span class=\"number\">1</span>,<span class=\"string\">'YUY2_640x480'</span>)</span><br></pre></td></tr></table></figure>\n<p>下面上简单的代码：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vid = videoinput(<span class=\"string\">'winvideo'</span>,<span class=\"number\">1</span>,<span class=\"string\">'YUY2_640x480'</span>);   %选择摄像头和格式</span><br><span class=\"line\">preview (vid);    \t\t\t%显示vid函数中摄像头拍摄的画面</span><br><span class=\"line\">frame = getsnapshot(vid);   \t\t\t%获取每一帧的图片</span><br><span class=\"line\">figure;imshow(frame);   \t\t%在figure中显示出摄像头拍摄的画面</span><br><span class=\"line\">\t%如果想保存图片可以使用下面的函数</span><br><span class=\"line\">\t%但这种函数保存打开摄像头那一瞬间的图片</span><br><span class=\"line\">\t%有时间我将介绍如何使用gui去实现随时拍照的代码，</span><br><span class=\"line\">imwrite(frame,<span class=\"string\">'A.png'</span>);</span><br></pre></td></tr></table></figure>\n<p>下面是微微复杂点的代码，一般在实战中会用到，单纯是想玩的话，上面的代码已经够了。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">obj = videoinput(<span class=\"string\">'winvideo'</span>,<span class=\"number\">1</span>,<span class=\"string\">'YUY2_640×480'</span>)；</span><br><span class=\"line\">%winvideo<span class=\"string\">'由函数imaqhwinfo查出</span></span><br><span class=\"line\"><span class=\"string\">set(vid,'</span>FramesPerTrigge<span class=\"string\">r',1);</span></span><br><span class=\"line\"><span class=\"string\">%FramesPerTrigger用特定的帧数去捕获选定的视频 </span></span><br><span class=\"line\"><span class=\"string\">set(vid, '</span>TriggerRepeat<span class=\"string\">', Inf);</span></span><br><span class=\"line\"><span class=\"string\">%不断地触发TriggerRepeat，以上代码一般不需要改动</span></span><br><span class=\"line\"><span class=\"string\">set(vid,'</span>ReturnedColorSpace<span class=\"string\">','</span>rg<span class=\"string\">b');</span></span><br><span class=\"line\"><span class=\"string\">%设置返回的视频颜色，‘rgb’是正常颜色，需要返回其他色彩可以在做改动</span></span><br><span class=\"line\"><span class=\"string\">vidRes=get(obj,'</span>VideoResolution<span class=\"string\">');         </span></span><br><span class=\"line\"><span class=\"string\">%获得视频的长与宽，是二维数组</span></span><br><span class=\"line\"><span class=\"string\">nBands=get(obj,'</span>NumberOfBands<span class=\"string\">');           </span></span><br><span class=\"line\"><span class=\"string\">%获得图像的颜色层数</span></span><br><span class=\"line\"><span class=\"string\">hImage=image(zeros(vidRes(2),vidRes(1),nBands));</span></span><br><span class=\"line\"><span class=\"string\">%获得图像的句柄</span></span><br><span class=\"line\"><span class=\"string\">preview(obj,hImage);</span></span><br><span class=\"line\"><span class=\"string\">%以上是我对这些代码的理解，具体情况在这里就没法细说了</span></span><br></pre></td></tr></table></figure>\n<p>这里就把简单的介绍完了。</p>\n<p>建议有需要的朋友使用GUI去实现对视频、图片的播放、保存、并做相应处理的操作。</p>\n<p>有时间我会把我的项目再深入介绍一下如何对这些进行操作，如果有感兴趣的朋友也可以联系我。</p>\n","url":"/posts/60879/","min2read":3,"word4post":820,"prev_post":{"title":"Anaconda镜像下载地址","url":"/posts/37594/"},"next_post":{"title":"MATLAB账户未关联到许可证—无法打开help文档—解决方法","url":"/posts/62961/"},"toc":"","categories":[{"name":"MATLAB","path":"api/categories/MATLAB.json","url":"/categories/MATLAB/"}],"tags":[{"name":"MATLAB","path":"api/tags/MATLAB.json","url":"/tags/MATLAB/"}]}