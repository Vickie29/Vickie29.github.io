{"title":"使用MATLAB调用摄像头并拍照—详细代码","slug":"使用MATLAB调用摄像头并拍照—详细代码","date":"2020-06-17","updated":"2020-07-08","comments":true,"path":"api/posts/50105.json","excerpt":"<blockquote><p>大家也可以加我的交流群，所有资料我会在群里分享出来哦：977947271<br>2020/5/30：</p></blockquote><p>今天给大家介绍一下我第一次使用matlab进行摄像头拍照并进行图像处理的过程</p><p>下面是个简单的GUI：</p><p></p>","cover":"https://img-blog.csdnimg.cn/20200219115644543.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTA0MTE5,size_16,color_FFFFFF,t_70","covers":["https://img-blog.csdnimg.cn/20200219115644543.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTA0MTE5,size_16,color_FFFFFF,t_70"],"content":"<blockquote>\n<p>大家也可以加我的交流群，所有资料我会在群里分享出来哦：977947271<br>2020/5/30：</p>\n</blockquote>\n<p>今天给大家介绍一下我第一次使用matlab进行摄像头拍照并进行图像处理的过程</p>\n<p>下面是个简单的GUI：</p>\n<p><img src=\"https://img-blog.csdnimg.cn/20200219115644543.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTA0MTE5,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\"></p>\n<a id=\"more\"></a>\n<p>虽然不使用GUI也可以实现这种功能，不过我建议初学者最好使用GUI来控制程序，之后有时间我会发布不使用GUI来实现这种功能的博文。</p>\n<p>GUI界面的建立这里就不多说了。</p>\n<p>这个GUI是由一个坐标轴和四个按钮组成，按钮分别是“打开摄像头”，“拍照并保存”，“关闭摄像头”，“图像处理”，对应代码中的pushbutton1/2/3/4。</p>\n<p>目的是先打开摄像头，再拍摄照片到电脑中，最后调用图片去进行处理。</p>\n<p>下面介绍代码：<br>这里是 pushbutton1 的callback</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">varargout&#123;<span class=\"number\">1</span>&#125; = handles.output;</span><br><span class=\"line\"><span class=\"keyword\">global</span> vid</span><br><span class=\"line\">%定义一个全局变量，<span class=\"keyword\">global</span>的用法可以参照我的另一篇博文</span><br><span class=\"line\">vid = videoinput(<span class=\"string\">'winvideo'</span>,<span class=\"number\">1</span>,<span class=\"string\">'YUY2_640x480'</span>);</span><br><span class=\"line\">%winvideo函数可参照另一篇文章中imaqhwinfo的用法</span><br><span class=\"line\">set(vid,<span class=\"string\">'FramesPerTrigger'</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">%用特定的帧数去显示视频</span><br><span class=\"line\">set(vid,<span class=\"string\">'TriggerRepeat'</span>,Inf);</span><br><span class=\"line\">vidRes = get(vid,<span class=\"string\">'VideoResolution'</span>);</span><br><span class=\"line\">%二维数组，获取视频长宽</span><br><span class=\"line\">nBands = get(ojb,<span class=\"string\">'NumberOfBands'</span>);</span><br><span class=\"line\">%获得图像的颜色层数</span><br><span class=\"line\">axes(handles.axes1);</span><br><span class=\"line\">%让视频显示在指定的axes1坐标中</span><br><span class=\"line\"><span class=\"keyword\">global</span> hImage</span><br><span class=\"line\">%定义全局变量hImage</span><br><span class=\"line\">hImage = image(zeros(vidRes(<span class=\"number\">2</span>),vidRes(<span class=\"number\">1</span>),nBands));</span><br><span class=\"line\">%获得图像的句柄</span><br><span class=\"line\">preview（vid,hImage）;</span><br></pre></td></tr></table></figure>\n<p>点开“打开摄像头后”在 axes1 中就可看到拍摄的画面</p>\n<p>接下来介绍图片的保存：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">global</span> vid;</span><br><span class=\"line\">frame = getsnapshot(vid);</span><br><span class=\"line\">%摄像头每一帧的画面</span><br><span class=\"line\">frame = ycbcr2rgb(frame);</span><br><span class=\"line\">%将捕获的图像转化为RGB格式的图像</span><br><span class=\"line\">[filename,pathname] = uiputfile(&#123;<span class=\"string\">'*.bmp'</span>,<span class=\"string\">'BMP files'</span>:<span class=\"string\">'*.jpg'</span>,<span class=\"string\">'JPG files'</span>&#125;<span class=\"string\">'格式'</span>);</span><br><span class=\"line\">%照片名称与储存路径</span><br><span class=\"line\"><span class=\"keyword\">if</span> isequal(filename,<span class=\"number\">0</span>) || isequal(pathname,<span class=\"number\">0</span>)</span><br><span class=\"line\">%文件名与路径是否被占用</span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\"><span class=\"keyword\">else</span> </span><br><span class=\"line\">\tfpath = fullfile(pathname,filename);</span><br><span class=\"line\">end</span><br><span class=\"line\">imwrite(frame,fpath);</span><br></pre></td></tr></table></figure>\n<p>其实这种操作的逻辑对于matlab 的GUI来说，都可以比较简便的解决</p>\n<p>关闭摄像头：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%很简单，在callback中写入一个函数即可</span><br><span class=\"line\">close（findobj(<span class=\"string\">'gca'</span>,<span class=\"string\">'figure_csdn'</span>)）;</span><br><span class=\"line\">%findobj(<span class=\"string\">'PropertyName'</span>,<span class=\"string\">'PropertyValue'</span>,...)</span><br><span class=\"line\">返回figure的句柄</span><br></pre></td></tr></table></figure>\n<p>对于想要对图像进行处理的话：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%就需要在callback中写入读取上图保存的图片的代码</span><br><span class=\"line\">x = imread(<span class=\"string\">'name.jpg'</span>);</span><br><span class=\"line\">imshow(x);</span><br><span class=\"line\">%在进行相应的处理程序</span><br></pre></td></tr></table></figure>\n<p>因为 gui 的代码冗长且很多地方无用，就无法将代码全部贴出来，但是对于有些基础的是可以看懂的，所有代码都放在相应的cb中进行。</p>\n<p>之后会发出更复杂的定时拍照的程序 gui，希望有技术大佬可以帮助指点错误与不足。</p>\n<p>如果有需要这篇文章中源码和 gui 的可以私信我。</p>\n<p>欢迎大家指正不足。</p>\n","url":"/posts/50105/","min2read":2,"word4post":702,"prev_post":{"title":"MATLAB 的global函数（全局变量）—从python和MAT实例中详细解释","url":"/posts/43318/"},"next_post":{"title":"新手如何使用anaconda（python）—简单介绍","url":"/posts/50452/"},"toc":"","categories":[{"name":"MATLAB","path":"api/categories/MATLAB.json","url":"/categories/MATLAB/"}],"tags":[{"name":"MATLAB","path":"api/tags/MATLAB.json","url":"/tags/MATLAB/"}]}